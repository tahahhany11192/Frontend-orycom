<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/jpg" href="../../uploads/orycomLogo.png">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Excel Data Management | Ed-Arycom</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-blue: #1a73e8;
      --secondary-blue: #4285f4;
      --accent-blue: #64b5f6;
      --dark-blue: #0d47a1;
      --light-blue: #e3f2fd;
      --background-blue: #f0f7ff;
      --success-green: #4caf50;
      --warning-orange: #ff9800;
      --error-red: #f44336;
      --purple: #9c27b0;
      --teal: #009688;
      --pink: #e91e63;
      --text-dark: #202124;
      --text-medium: #5f6368;
      --text-light: #ffffff;
      --border-color: #dadce0;
      --card-shadow: 0 4px 12px rgba(66, 133, 244, 0.15);
      --sidebar-width: 260px;
      --animation-duration: 0.5s;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--background-blue);
      color: var(--text-dark);
      display: flex;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Sidebar Styles */
    .sidebar {
      width: var(--sidebar-width);
      background: linear-gradient(to bottom, var(--primary-blue), var(--dark-blue));
      color: var(--text-light);
      padding: 25px 0;
      height: 100vh;
      position: fixed;
      overflow-y: auto;
      transition: all 0.3s ease;
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      padding: 0 25px 25px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 25px;
    }

    .logo i {
      font-size: 28px;
      margin-right: 12px;
    }

    .logo h1 {
      font-size: 22px;
      font-weight: 600;
    }

    .nav-links {
      list-style: none;
      padding: 0 15px;
    }

    .nav-links li {
      margin-bottom: 5px;
    }

    .nav-links a {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      color: rgba(255, 255, 255, 0.9);
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .nav-links a:hover, .nav-links a.active {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      transform: translateX(5px);
    }

    .nav-links i {
      font-size: 20px;
      margin-right: 12px;
      width: 24px;
      text-align: center;
    }

    /* Main Content Styles */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 30px;
      transition: all var(--animation-duration) ease;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .header h2 {
      font-size: 24px;
      font-weight: 600;
      color: var(--primary-blue);
      animation: fadeInDown var(--animation-duration) ease;
    }

    .user-info {
      display: flex;
      align-items: center;
      position: relative;
      animation: fadeInRight var(--animation-duration) ease;
    }

    .user-info img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 12px;
      border: 2px solid var(--primary-blue);
    }

    .logout-btn {
      background: var(--error-red);
      color: white;
      border: none;
      padding: 8px 16px;
      font-size: 14px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      margin-left: 15px;
    }

    .logout-btn:hover {
      background: #d32f2f;
      transform: translateY(-2px);
    }

    /* Dashboard Cards */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: var(--card-shadow);
      transition: all 0.3s ease;
      border: none;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(66, 133, 244, 0.2);
    }

    .card-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
      font-size: 24px;
    }

    .card:nth-child(1) .card-icon { background: rgba(76, 175, 80, 0.2); color: var(--success-green); }
    .card:nth-child(2) .card-icon { background: rgba(156, 39, 176, 0.2); color: var(--purple); }
    .card:nth-child(3) .card-icon { background: rgba(255, 152, 0, 0.2); color: var(--warning-orange); }
    .card:nth-child(4) .card-icon { background: rgba(244, 67, 54, 0.2); color: var(--error-red); }

    .card h3 {
      font-size: 16px;
      color: var(--text-medium);
      margin-bottom: 8px;
    }

    .card p {
      font-size: 24px;
      font-weight: 600;
      color: var(--text-dark);
    }

    /* Sheet Navigation */
    .sheet-navigation {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .sheet-btn {
      background: white;
      border: 1px solid var(--border-color);
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 500;
    }

    .sheet-btn:hover {
      background: var(--light-blue);
      border-color: var(--primary-blue);
    }

    .sheet-btn.active {
      background: var(--primary-blue);
      color: white;
      border-color: var(--primary-blue);
    }

    /* Table Styles */
    .table-container {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: var(--card-shadow);
      animation: fadeInUp var(--animation-duration) ease;
      overflow-x: auto;
    }

    .table-container h3 {
      font-size: 18px;
      color: var(--primary-blue);
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      min-width: 800px;
    }

    .table th {
      background-color: var(--light-blue);
      color: var(--primary-blue);
      font-weight: 600;
      padding: 12px 15px;
      text-align: left;
      border-bottom: 2px solid var(--border-color);
      position: sticky;
      top: 0;
    }

    .table td {
      padding: 12px 15px;
      border-bottom: 1px solid var(--border-color);
      vertical-align: middle;
    }

    .table tr:last-child td {
      border-bottom: none;
    }

    .table tr:hover td {
      background-color: rgba(100, 181, 246, 0.1);
    }

    .editable-cell {
      position: relative;
    }

    .editable-cell input {
      width: 100%;
      padding: 8px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
    }

    .editable-cell input:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
    }

    .btn-sm {
      padding: 5px 10px;
      font-size: 12px;
      line-height: 1.5;
      border-radius: 4px;
    }

    .btn-primary {
      background-color: var(--primary-blue);
      border-color: var(--primary-blue);
    }

    .btn-success {
      background-color: var(--success-green);
      border-color: var(--success-green);
    }

    .btn-danger {
      background-color: var(--error-red);
      border-color: var(--error-red);
    }

    .btn-primary:hover {
      background-color: #0d47a1;
      border-color: #0d47a1;
    }

    .btn-success:hover {
      background-color: #3d8b40;
      border-color: #3d8b40;
    }

    .btn-danger:hover {
      background-color: #d32f2f;
      border-color: #d32f2f;
    }

    /* Modal Styles */
    .modal-content {
      border-radius: 12px;
      border: none;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }

    .modal-header {
      background: var(--light-blue);
      border-bottom: 1px solid var(--border-color);
      border-radius: 12px 12px 0 0;
      padding: 15px 20px;
    }

    .modal-title {
      color: var(--primary-blue);
      font-weight: 600;
    }

    .modal-body {
      padding: 20px;
    }

    .modal-footer {
      border-top: 1px solid var(--border-color);
      padding: 15px 20px;
      border-radius: 0 0 12px 12px;
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInLeft {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes fadeInRight {
      from {
        opacity: 0;
        transform: translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .animated {
      animation-duration: var(--animation-duration);
      animation-fill-mode: both;
    }

    /* Responsive styles */
    @media (max-width: 1200px) {
      .sidebar {
        width: 80px;
      }
      .logo h1, .nav-links span {
        display: none;
      }
      .logo {
        justify-content: center;
        padding: 0 0 25px;
      }
      .logo i {
        margin-right: 0;
        font-size: 32px;
      }
      .nav-links a {
        justify-content: center;
      }
      .nav-links i {
        margin-right: 0;
        font-size: 22px;
      }
      .main-content {
        margin-left: 80px;
      }
    }

    @media (max-width: 992px) {
      .table-container {
        padding: 15px;
      }
      
      .dashboard-cards {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
      .user-info {
        margin-top: 15px;
      }
      
      .dashboard-cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="logo">
      <i class="fas fa-graduation-cap"></i>
      <h1>EduArycom</h1>
    </div>
    
    <ul class="nav-links">
      <li><a href="dashboard.html"><i class="fas fa-home"></i> <span>Dashboard</span></a></li>
      <li><a href="create-course.html"><i class="fas fa-graduation-cap"></i> <span>Courses</span></a></li>
      <li><a href="Create-Lesson.html"><i class="fas fa-book"></i> <span>Courses Content</span></a></li>
      <li><a href="StudentsControl.html"><i class="fas fa-users"></i> <span>Students</span></a></li>
      <li><a href="Instructors.html"><i class="fas fa-chalkboard-teacher"></i> <span>Instructors</span></a></li>
      <li><a href="Analytics.html"><i class="fas fa-chart-line"></i> <span>Analytics</span></a></li>
      <li><a href="#"><i class="fas fa-money-bill-wave"></i> <span>Payment Requests</span></a></li>
      <li><a href="#" class="active"><i class="fas fa-file-excel"></i> <span>Excel Data</span></a></li>
      <li><a href="settings.html"><i class="fas fa-cog"></i> <span>Settings</span></a></li>
      <li><a href="#"><i class="fas fa-question-circle"></i> <span>Help</span></a></li>
    </ul>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <div class="header">
      <h2 class="animated fadeInDown">Excel Data Management</h2>
      <div class="user-info animated fadeInRight">
        <img src="https://randomuser.me/api/portraits/men/41.jpg" alt="Admin">
        <div>
          <h4>Admin User</h4>
          <p>System Administrator</p>
        </div>
        <button class="logout-btn" id="logoutBtn">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>

    <!-- Dashboard Cards -->
    <div class="dashboard-cards">
      <div class="card animated fadeInUp" style="animation-delay: 0.1s;">
        <div class="card-icon">
          <i class="fas fa-table"></i>
        </div>
        <h3>Total Sheets</h3>
        <p id="totalSheets">14</p>
      </div>
      <div class="card animated fadeInUp" style="animation-delay: 0.2s;">
        <div class="card-icon">
          <i class="fas fa-columns"></i>
        </div>
        <h3>Total Columns</h3>
        <p id="totalColumns">186</p>
      </div>
      <div class="card animated fadeInUp" style="animation-delay: 0.3s;">
        <div class="card-icon">
          <i class="fas fa-list"></i>
        </div>
        <h3>Total Rows</h3>
        <p id="totalRows">245</p>
      </div>
      <div class="card animated fadeInUp" style="animation-delay: 0.4s;">
        <div class="card-icon">
          <i class="fas fa-sync"></i>
        </div>
        <h3>Last Updated</h3>
        <p id="lastUpdated">Just now</p>
      </div>
    </div>

    <!-- Sheet Navigation -->
    <div class="sheet-navigation">
      <button class="sheet-btn active" data-sheet="الطلبه">الطلبه</button>
      <button class="sheet-btn" data-sheet="الباقات 1">الباقات 1</button>
      <button class="sheet-btn" data-sheet="باقات 12 ثانوي">باقات 12 ثانوي</button>
      <button class="sheet-btn" data-sheet="المساعدين">المساعدين</button>
      <button class="sheet-btn" data-sheet="الكورسات">الكورسات</button>
      <button class="sheet-btn" data-sheet="المواعيد المدرسين">المواعيد المدرسين</button>
      <button class="sheet-btn" data-sheet="الاشتركات">الاشتركات</button>
      <button class="sheet-btn" data-sheet="dails">dails</button>
      <button class="sheet-btn" data-sheet="cooding">cooding</button>
      <button class="sheet-btn" data-sheet="الموظفين">الموظفين</button>
    </div>

    <!-- Excel Data Table -->
    <div class="table-container animated fadeInUp">
      <h3>
        <span id="currentSheetName">الطلبه</span>
        <div>
          <button class="btn btn-primary btn-sm" id="addRowBtn">
            <i class="fas fa-plus"></i> Add Row
          </button>
          <button class="btn btn-success btn-sm" id="saveChangesBtn">
            <i class="fas fa-save"></i> Save Changes
          </button>
        </div>
      </h3>
      <div class="table-responsive">
        <table class="table" id="excelTable">
          <thead id="tableHeader"></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Add Row Modal -->
  <div class="modal fade" id="addRowModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add New Row</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modalForm">
          <!-- Form will be generated dynamically -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="confirmAddRow">Add Row</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // 1. Check for adminToken in localStorage
    const adminToken = localStorage.getItem('adminToken');
    if (!adminToken) {
      // 2. Redirect to login if token not present
      window.location.href = '../OrycomEdu/OrycomLogin.html';
    }

    // 3. Logout functionality
    const logoutBtn = document.getElementById('logoutBtn');
    logoutBtn.addEventListener('click', () => {
      localStorage.removeItem('adminToken');
      window.location.href = '../OrycomEdu/OrycomLogin.html';
    });

    // Excel data structure
    const excelData = {
      "الطلبه": [
        ["السعر", "منصه", "نوفا", "الباقي", "دخلي", "النسبه", "عدد الطلبه", "المدفو ع", "نسبه نوفا", "حساب السنتر", "صافي ارباح", "سعر الكرسي في القاعه", "سعر الكرسي IG", "سعر الكرسي A", "Column1"],
        [80.0, 10.0, 10.0, 60.0, 20.0, 0.3, 10.0, 800.0, 240.0, 300.0, 260.0, 30.0, "", "", ""],
        [85.0, 15.0, 10.0, 60.0, 25.0, 0.3, 10.0, 850.0, 255.0, 300.0, 295.0, 30.0, "", "", ""],
        [90.0, 15.0, 15.0, 60.0, 30.0, 0.3, 10.0, 900.0, 270.0, 300.0, 330.0, 30.0, "", "", ""],
        [95.0, 20.0, 15.0, 60.0, 35.0, 0.3, 10.0, 950.0, 285.0, 300.0, 365.0, 30.0, "", "", ""],
        [100.0, 15.0, 15.0, 70.0, 30.0, 0.3, 10.0, 1000.0, 300.0, 300.0, 400.0, 30.0, "", "", ""],
        [110.0, 15.0, 20.0, 75.0, 33.0, 0.3, 10.0, 1100.0, 330.0, 300.0, 470.0, 30.0, "", "", ""],
        [120.0, 20.0, 15.0, 85.0, 35.0, 0.3, 10.0, 1200.0, 360.0, 300.0, 540.0, 30.0, "", "", ""],
        [130.0, 20.0, 20.0, 90.0, 40.0, 0.3, 10.0, 1300.0, 390.0, 300.0, 610.0, 30.0, "", "", ""],
        [140.0, 20.0, 25.0, 95.0, 42.0, 0.3, 10.0, 1400.0, 420.0, 300.0, 680.0, 30.0, "", "", ""],
        [150.0, 25.0, 20.0, 95.0, 45.0, 0.3, 10.0, 1500.0, 450.0, 300.0, 750.0, 30.0, "", "", ""],
        [160.0, 25.0, 25.0, 110.0, 47.0, 0.3, 10.0, 1600.0, 480.0, 300.0, 820.0, 30.0, "", "", ""],
        [170.0, 25.0, 25.0, 120.0, 50.0, 0.3, 10.0, 1700.0, 510.0, 300.0, 890.0, 30.0, "", "", ""],
        [180.0, 25.0, 30.0, 125.0, 55.0, 0.3, 10.0, 1800.0, 540.0, 300.0, 960.0, 30.0, "", "", ""],
        [190.0, 30.0, 30.0, 130.0, 57.0, 0.3, 10.0, 1900.0, 570.0, 300.0, 1030.0, 30.0, "", "", ""],
        [200.0, 30.0, 30.0, 140.0, 60.0, 0.3, 10.0, 2000.0, 600.0, 300.0, 1100.0, 30.0, "", "", ""],
        [210.0, 30.0, 35.0, 145.0, 63.0, 0.3, 10.0, 2100.0, 630.0, 300.0, 1170.0, 30.0, "", "", ""],
        [220.0, 35.0, 30.0, 150.0, 66.0, 0.3, 10.0, 2200.0, 660.0, 300.0, 1240.0, 30.0, "", "", ""],
        [230.0, 35.0, 35.0, 155.0, 69.0, 0.3, 10.0, 2300.0, 690.0, 300.0, 1310.0, 30.0, "", "", ""],
        [240.0, 35.0, 35.0, 160.0, 72.0, 0.3, 10.0, 2400.0, 720.0, 300.0, 1380.0, 30.0, "", "", ""],
        [250.0, 40.0, 35.0, 165.0, 75.0, 0.3, 10.0, 2500.0, 750.0, 1000.0, 750.0, "", 100.0, 60.0, 600.0],
        [260.0, 40.0, 40.0, 170.0, 78.0, 0.3, 10.0, 2600.0, 780.0, 1000.0, 820.0, "", 100.0, 60.0, 600.0],
        [270.0, 40.0, 40.0, 175.0, 81.0, 0.3, 10.0, 2700.0, 810.0, 1000.0, 890.0, "", 100.0, 60.0, 600.0],
        [280.0, 45.0, 40.0, 180.0, 84.0, 0.3, 10.0, 2800.0, 840.0, 1000.0, 960.0, "", 100.0, 60.0, 600.0],
        [290.0, 45.0, 45.0, 185.0, 87.0, 0.3, 10.0, 2900.0, 870.0, 1000.0, 1030.0, "", 100.0, 60.0, 600.0],
        [300.0, 45.0, 45.0, 190.0, 90.0, 0.3, 10.0, 3000.0, 900.0, 1000.0, 1100.0, "", 100.0, 60.0, 600.0],
        [310.0, 50.0, 45.0, 195.0, 93.0, 0.3, 10.0, 3100.0, 930.0, 1000.0, 1170.0, "", 100.0, 60.0, 600.0],
        [320.0, 45.0, 50.0, 200.0, 96.0, 0.3, 10.0, 3200.0, 960.0, 1000.0, 1240.0, "", 100.0, 60.0, 600.0],
        [330.0, 50.0, 50.0, 205.0, 99.0, 0.3, 10.0, 3300.0, 990.0, 1000.0, 1310.0, "", 100.0, 60.0, 600.0],
        [340.0, 50.0, 50.0, 210.0, 102.0, 0.3, 10.0, 3400.0, 1020.0, 1000.0, 1380.0, "", 100.0, 60.0, 600.0],
        [350.0, 55.0, 50.0, 215.0, 105.0, 0.3, 10.0, 3500.0, 1050.0, 1000.0, 1450.0, "", 100.0, 60.0, 600.0],
        [360.0, 50.0, 55.0, 220.0, 108.0, 0.3, 10.0, 3600.0, 1080.0, 1000.0, 1520.0, "", 100.0, 60.0, 600.0],
        [370.0, 55.0, 55.0, 225.0, 111.0, 0.3, 10.0, 3700.0, 1110.0, 1000.0, 1590.0, "", 100.0, 60.0, 600.0],
        [380.0, 55.0, 60.0, 230.0, 114.0, 0.3, 10.0, 3800.0, 1140.0, 1000.0, 1660.0, "", 100.0, 60.0, 600.0],
        [390.0, 60.0, 55.0, 235.0, 117.0, 0.3, 10.0, 3900.0, 1170.0, 1000.0, 1730.0, "", 100.0, 60.0, 600.0],
        [400.0, 60.0, 60.0, 240.0, 120.0, 0.3, 10.0, 4000.0, 1200.0, 1000.0, 1800.0, "", 100.0, 60.0, 600.0],
        [410.0, 60.0, 60.0, 245.0, 123.0, 0.3, 10.0, 4100.0, 1230.0, 1000.0, 1870.0, "", 100.0, 60.0, 600.0],
        [420.0, 65.0, 60.0, 250.0, 126.0, 0.3, 10.0, 4200.0, 1260.0, 1000.0, 1940.0, "", 100.0, 60.0, 600.0],
        [430.0, 65.0, 65.0, 255.0, 129.0, 0.3, 10.0, 4300.0, 1290.0, 1000.0, 2010.0, "", 100.0, 60.0, 600.0],
        [440.0, 65.0, 65.0, 260.0, 132.0, 0.3, 10.0, 4400.0, 1320.0, 1000.0, 2080.0, "", 100.0, 60.0, 600.0],
        [450.0, 65.0, 70.0, 265.0, 135.0, 0.3, 10.0, 4500.0, 1350.0, 1000.0, 2150.0, "", 100.0, 60.0, 600.0],
        [460.0, 70.0, 70.0, 270.0, 138.0, 0.3, 10.0, 4600.0, 1380.0, 1000.0, 2220.0, "", 100.0, 60.0, 600.0],
        [470.0, 70.0, 70.0, 275.0, 141.0, 0.3, 10.0, 4700.0, 1410.0, 1000.0, 2290.0, "", 100.0, 60.0, 600.0],
        [480.0, 75.0, 70.0, 280.0, 144.0, 0.3, 10.0, 4800.0, 1440.0, 1000.0, 2360.0, "", 100.0, 60.0, 600.0],
        [490.0, 70.0, 75.0, 285.0, 147.0, 0.3, 10.0, 4900.0, 1470.0, 1000.0, 2430.0, "", 100.0, 60.0, 600.0],
        [500.0, 75.0, 75.0, 290.0, 150.0, 0.3, 10.0, 5000.0, 1500.0, 1000.0, 2500.0, "", 100.0, 60.0, 600.0],
        [510.0, 75.0, 80.0, 295.0, 153.0, 0.3, 10.0, 5100.0, 1530.0, 1000.0, 2570.0, "", 100.0, 60.0, 600.0],
        [520.0, 80.0, 75.0, 300.0, 156.0, 0.3, 10.0, 5200.0, 1560.0, 1000.0, 2640.0, "", 100.0, 60.0, 600.0],
        [530.0, 80.0, 80.0, 305.0, 159.0, 0.3, 10.0, 5300.0, 1590.0, 1000.0, 2710.0, "", 100.0, 60.0, 600.0],
        [540.0, 80.0, 80.0, 310.0, 162.0, 0.3, 10.0, 5400.0, 1620.0, 1000.0, 2780.0, "", 100.0, 60.0, 600.0],
        [550.0, 85.0, 80.0, 315.0, 165.0, 0.3, 10.0, 5500.0, 1650.0, 1000.0, 2850.0, "", 100.0, 60.0, 600.0],
        [560.0, 80.0, 85.0, 320.0, 168.0, 0.3, 10.0, 5600.0, 1680.0, 1000.0, 2920.0, "", 100.0, 60.0, 600.0],
        [570.0, 85.0, 85.0, 325.0, 171.0, 0.3, 10.0, 5700.0, 1710.0, 1000.0, 2990.0, "", 100.0, 60.0, 600.0],
        [580.0, 90.0, 85.0, 330.0, 174.0, 0.3, 10.0, 5800.0, 1740.0, 1000.0, 3060.0, "", 100.0, 60.0, 600.0],
        [590.0, 85.0, 90.0, 335.0, 177.0, 0.3, 10.0, 5900.0, 1770.0, 1000.0, 3130.0, "", 100.0, 60.0, 600.0],
        [600.0, 90.0, 90.0, 340.0, 180.0, 0.3, 10.0, 6000.0, 1800.0, 1000.0, 3200.0, "", 100.0, 60.0, 600.0],
        ["20$", "3$", "3$", "14$", "6$", 0.3, 10.0, "200$", "60$", "", "140$", "", "", "", ""],
        ["25$", "4$", "3$", "18$", "7$", 0.3, 10.0, "250$", "75$", "", "175$", "", "", "", ""],
        ["30$", "5$", "4$", "21$", "9$", 0.3, 10.0, "300$", "90$", "", "210$", "", "", "", ""],
        ["35$", "5$", "5$", "25$", "10$", 0.3, 10.0, "350$", "105$", "", "245$", "", "", "", ""],
        ["40$", "6$", "6$", "28$", "12$", 0.3, 10.0, "400$", "120$", "", "280$", "", "", "", ""]
      ],
      "الباقات 1": [
        ["#", "1", "2", "3", "4", "5"],
        ["السعر", 6000.0, 8000.0, 12000.0, 16000.0, 10000.0],
        ["امتحانات", "on line / off line", "on line / off line", "on line / off line", "on line / off line", "on line / off line"],
        ["عدد الامتحانات", 10.0, 16.0, 28.0, "FREE", 24.0],
        ["سعر الامتحانات", 100.0, 100.0, 100.0, 100.0, 100.0],
        ["تصوير الورق", 500.0, 700.0, 900.0, 1200.0, 750.0],
        ["سعر تصوير الورق", 1000.0, 1400.0, 1800.0, 2400.0, 1500.0],
        ["عدد ساعات تصوير", 8.0, 12.0, 18.0, 24.0, 16.0],
        ["سعر التصوير في الساعة", "100/150", "100/150", "100/150", "100/150", "100/150"],
        ["عدد مرات المنتاج", 3.0, 5.0, 7.0, 10.0, 6.0],
        ["سعر المنتاج", "200 /300", "200 /300", "200 /300", "200 /300", "200 /300"],
        ["عدد مرات data", 22.0, 35.0, "free", "free", 45.0],
        ["سعر data", 50.0, 25.0, "free", "free", ""],
        ["REEL", 5.0, 10.0, 16.0, 30.0, 15.0],
        ["سعر ال REEL", 200.0, 200.0, 200.0, 200.0, 200.0],
        ["تصميم", 4.0, 6.0, 12.0, 32.0, 9.0],
        ["المواعيد", "-", "اختيار ثانوي", "اختيار اول", "اختيار اول", ""],
        ["الدعيا و السوشيال ميديا", "-", "محدود", "مفتوح", "مفتوح", ""],
        ["التصوير", "-", 100.0, 100.0, 100.0, 100.0],
        ["التوب علي المنصه", "-", "2 weeks", "1 month", "2 month", ""],
        ["LIVE CHAT", "-", 6.0, 12.0, 24.0, 6.0],
        ["", "", "", "", "", ""],
        ["", "", "", "", "", ""],
        ["داخل", 3000.0, 4225.0, 8100.0, 10400.0, 4225.0],
        ["مصروفات", 3000.0, 3775.0, 3900.0, 5600.0, 3775.0],
        ["شكلي", 5400.0, 8675.0, 9800.0, 12800.0, 8675.0],
        ["NOVA", 900.0, 1200.0, 2400.0, 3100.0, 1200.0]
      ],
      // Other sheets would be defined here...
    };

    // Current sheet data
    let currentSheet = "الطلبه";
    let modifiedData = JSON.parse(JSON.stringify(excelData));

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      // Set up sheet navigation
      const sheetButtons = document.querySelectorAll('.sheet-btn');
      sheetButtons.forEach(button => {
        button.addEventListener('click', function() {
          const sheetName = this.getAttribute('data-sheet');
          switchSheet(sheetName);
          
          // Update active button
          sheetButtons.forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // Set up add row button
      document.getElementById('addRowBtn').addEventListener('click', showAddRowModal);
      
      // Set up save changes button
      document.getElementById('saveChangesBtn').addEventListener('click', saveChanges);
      
      // Set up confirm add row button
      document.getElementById('confirmAddRow').addEventListener('click', addNewRow);
      
      // Load initial sheet
      switchSheet(currentSheet);
      
      // Calculate and display stats
      updateStats();
    });

    // Switch between sheets
    function switchSheet(sheetName) {
      currentSheet = sheetName;
      document.getElementById('currentSheetName').textContent = sheetName;
      renderTable();
    }

    // Render the table for the current sheet
    function renderTable() {
      const headerRow = document.getElementById('tableHeader');
      const tableBody = document.getElementById('tableBody');
      
      // Clear existing content
      headerRow.innerHTML = '';
      tableBody.innerHTML = '';
      
      // Get data for current sheet
      const sheetData = modifiedData[currentSheet];
      if (!sheetData || sheetData.length === 0) return;
      
      // Create header row
      const headerTr = document.createElement('tr');
      // Add index column header
      const indexTh = document.createElement('th');
      indexTh.textContent = '#';
      headerTr.appendChild(indexTh);
      
      // Add data headers
      sheetData[0].forEach(header => {
        const th = document.createElement('th');
        th.textContent = header;
        headerTr.appendChild(th);
      });
      
      // Add actions header
      const actionsTh = document.createElement('th');
      actionsTh.textContent = 'Actions';
      headerTr.appendChild(actionsTh);
      
      headerRow.appendChild(headerTr);
      
      // Create data rows
      for (let i = 1; i < sheetData.length; i++) {
        const rowData = sheetData[i];
        const tr = document.createElement('tr');
        
        // Add row index
        const indexTd = document.createElement('td');
        indexTd.textContent = i;
        indexTd.style.fontWeight = 'bold';
        tr.appendChild(indexTd);
        
        // Add data cells
        rowData.forEach((cell, j) => {
          const td = document.createElement('td');
          td.className = 'editable-cell';
          
          const input = document.createElement('input');
          input.type = 'text';
          input.value = cell;
          input.dataset.row = i;
          input.dataset.col = j;
          input.addEventListener('change', handleCellEdit);
          
          td.appendChild(input);
          tr.appendChild(td);
        });
        
        // Add delete button
        const actionsTd = document.createElement('td');
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'btn btn-danger btn-sm';
        deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
        deleteBtn.addEventListener('click', () => deleteRow(i));
        actionsTd.appendChild(deleteBtn);
        tr.appendChild(actionsTd);
        
        tableBody.appendChild(tr);
      }
    }

    // Handle cell edit
    function handleCellEdit(e) {
      const row = parseInt(e.target.dataset.row);
      const col = parseInt(e.target.dataset.col);
      const value = e.target.value;
      
      // Update the data
      modifiedData[currentSheet][row][col] = value;
    }

    // Show modal for adding a new row
    function showAddRowModal() {
      const modalForm = document.getElementById('modalForm');
      modalForm.innerHTML = '';
      
      // Get headers
      const headers = modifiedData[currentSheet][0];
      
      // Create form inputs for each column
      headers.forEach((header, index) => {
        const formGroup = document.createElement('div');
        formGroup.className = 'mb-3';
        
        const label = document.createElement('label');
        label.className = 'form-label';
        label.textContent = header;
        
        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'form-control';
        input.dataset.col = index;
        
        formGroup.appendChild(label);
        formGroup.appendChild(input);
        modalForm.appendChild(formGroup);
      });
      
      // Show the modal
      const modal = new bootstrap.Modal(document.getElementById('addRowModal'));
      modal.show();
    }

    // Add a new row to the table
    function addNewRow() {
      const inputs = document.querySelectorAll('#modalForm input');
      const newRow = [];
      
      inputs.forEach(input => {
        newRow.push(input.value);
      });
      
      // Add the new row to the data
      modifiedData[currentSheet].push(newRow);
      
      // Re-render the table
      renderTable();
      
      // Update stats
      updateStats();
      
      // Hide the modal
      const modal = bootstrap.Modal.getInstance(document.getElementById('addRowModal'));
      modal.hide();
    }

    // Delete a row
    function deleteRow(rowIndex) {
      if (confirm('Are you sure you want to delete this row?')) {
        modifiedData[currentSheet].splice(rowIndex, 1);
        renderTable();
        updateStats();
      }
    }

    // Save changes
    function saveChanges() {
      // In a real application, this would send the data to the server
      alert('Changes saved successfully!');
      
      // Update the last updated time
      document.getElementById('lastUpdated').textContent = new Date().toLocaleTimeString();
    }

    // Update statistics
    function updateStats() {
      let totalColumns = 0;
      let totalRows = 0;
      
      Object.keys(modifiedData).forEach(sheet => {
        if (modifiedData[sheet].length > 0) {
          totalColumns += modifiedData[sheet][0].length;
          totalRows += modifiedData[sheet].length - 1; // Subtract header row
        }
      });
      
      document.getElementById('totalColumns').textContent = totalColumns;
      document.getElementById('totalRows').textContent = totalRows;
    }

    // Make functions available globally
    window.handleCellEdit = handleCellEdit;
  </script>
</body>
</html>